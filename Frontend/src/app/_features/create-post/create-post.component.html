<div class="card-header d-flex justify-content-between">
  <div class="header-title">
    <h4 class="card-title">Create Post</h4>
  </div>
</div>
<div class="card-body">
  <div class="d-flex align-items-center">
    <div class="user-img">
      <img [src]="userImage" defaultImage="assets/images/user/11.jpg" alt="userimg" class="avatar-60 rounded-circle" height="100" width="100">
    </div>
    <form class="post-text ms-3 w-100" data-bs-toggle="modal" data-bs-target="#post-modal" action="#">
      <input type="text" class="form-control rounded" placeholder="Write something here..." [(ngModel)]="newPostContent"
             name="content" style="border:none;" required>
    </form>
  </div>
  <hr>
  <ul class="post-opt-block d-flex list-inline m-0 p-0 flex-wrap">
    <li class="post-opt-btn bg-soft-primary rounded p-2 pointer d-flex align-items-center me-3 mb-md-0 mb-2"
        (click)="fileInput.click()">
      <img ngSrc="assets/images/small/07.png" alt="icon" class="img-fluid me-2" height="24" width="24"> Photo/Video
      <input type="file" (change)="onFileSelected($event)" style="display: none;" #fileInput multiple>
    </li>
  </ul>
  <div class="selected-files mt-3">
    <div class="list-group">
      <div *ngFor="let file of selectedFiles; let i = index"
           class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
          <i class="ri-file-3-line me-2"></i>
          <span class="text-truncate">{{ file.name }}</span>
        </div>
        <button type="button" class="btn btn-sm btn-outline-danger" (click)="removeFile(i); $event.stopPropagation()">
          Remove
        </button>
      </div>
      <div *ngIf="selectedVideo"
           class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
          <i class="ri-file-3-line me-2"></i>
          <span class="text-truncate">{{ selectedVideo.name }}</span>
        </div>
        <button type="button" class="btn btn-sm btn-outline-danger" (click)="removeVideo(); $event.stopPropagation()">
          Remove
        </button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="post-modal" tabindex="-1" aria-labelledby="post-modalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-fullscreen-sm-down">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="post-modalLabel">Create Post</h5>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="ri-close-fill"></i></button>
      </div>
      <div class="modal-body">
        <div class="d-flex align-items-center">
          <div class="user-img">
            <img [src]="userImage" alt="userimg" class="avatar-60 rounded-circle img-fluid">
          </div>
          <form class="post-text ms-3 w-100" (ngSubmit)="createPost()">
            <input type="text" class="form-control rounded" placeholder="Write something here..."
                   [(ngModel)]="newPostContent" name="content" style="border:none;" required>
            <button type="submit" class="d-none"></button>
          </form>
        </div>
        <hr>
        <ul class="post-opt-block d-flex list-inline m-0 p-0 flex-wrap">
          <li class="post-opt-btn bg-soft-primary rounded p-2 pointer d-flex align-items-center me-3 mb-md-0 mb-2"
              (click)="fileInput.click()">
            <img ngSrc="assets/images/small/07.png" alt="icon" class="img-fluid me-2" height="24" width="24">
            Photo/Video
            <input type="file" (change)="onFileSelected($event)" style="display: none;" #fileInput multiple>
          </li>
          <li class="post-opt-btn bg-soft-primary rounded p-2 pointer d-flex align-items-center me-3 mb-md-0 mb-2">
            <img ngSrc="assets/images/small/08.png" alt="icon" class="img-fluid me-2" height="24" width="24"> Tag Friend
          </li>
        </ul>
        <div class="selected-files mt-3">
          <div class="list-group">
            <div *ngFor="let file of selectedFiles; let i = index"
                 class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
              <div class="d-flex align-items-center">
                <i class="ri-file-3-line me-2"></i>
                <span class="text-truncate">{{ file.name }}</span>
              </div>
              <button type="button" class="btn btn-sm btn-outline-danger"
                      (click)="removeFile(i); $event.stopPropagation()">Remove
              </button>
            </div>
            <div *ngIf="selectedVideo"
                 class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
              <div class="d-flex align-items-center">
                <i class="ri-file-3-line me-2"></i>
                <span class="text-truncate">{{ selectedVideo.name }}</span>
              </div>
              <button type="button" class="btn btn-sm btn-outline-danger"
                      (click)="removeVideo(); $event.stopPropagation()">Remove
              </button>
            </div>
          </div>
        </div>
        <hr>
        <div *ngIf="isUploading" class="mt-3">
          <div class="progress">
            <div class="progress-bar" role="progressbar" [style.width.%]="uploadProgress"
                 [attr.aria-valuenow]="uploadProgress" aria-valuemin="0" aria-valuemax="100">
              {{ uploadProgress }}%
            </div>
          </div>
        </div>

        <button class="btn btn-primary d-block w-100 mt-3" (click)="createPost()" [disabled]="isUploading">
          {{ isUploading ? 'Uploading...' : 'Post' }}
        </button>
      </div>
    </div>
  </div>
</div>

